{% extends "restaurant/base.html" %}
{% load static from staticfiles %}
{% load assets %}

{% load bootstrap_tags %}
{% block title %}套餐管理{% endblock %}
{% block page_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'css/ui/jquery-ui-bootstrap/jquery-ui-1.8.16.bootstrap.css' %}">
{% endblock %}
{% block page_js %}
    {% assets "jquery_ui_js" %}
        <script type="text/javascript" src="{% static ASSET_URL %}"></script>
    {% endassets %}
    {% assets "jquery_form_js" %}
        <script type="text/javascript" src="{% static ASSET_URL %}"></script>
    {% endassets %}
    {{ block.super }}
{% endblock %}
{% block content %}
    <div class="hide" id="add-menu-help-dialog">
        <div class="help-content">
            <p>1.如何添加一道菜或者一个分类到套餐中？<br/>&nbsp;&nbsp;&nbsp;&nbsp;拖动左边的菜或分类到右边的框中，或者双击左边的菜或分类，会自动添加到右侧
            </p>

            <p>2.如何从套餐中删除一道菜或者一个分类？<br/>&nbsp;&nbsp;&nbsp;&nbsp; 双击右侧的菜或分类或者点击最右边的关闭按钮</p>

            <p>3.如何调整菜或者分类在套餐中的显示顺序？<br/>&nbsp;&nbsp;&nbsp;&nbsp;在右侧可以上下拖动菜或者分类调整显示顺序</p>

            <p>4.如何调整菜或者分类在套餐中的显示顺序？<br/>&nbsp;&nbsp;&nbsp;&nbsp;在右侧可以上下拖动菜或者分类调整显示顺序</p></div>
    </div>

    <div class="well">
        <a class="fl" href="#" id="add-menu-help-link">操作帮助</a>

        <a class="add-category fr" href="#" id="add-category-link">添加分类</a>
    </div>
    <div class="row">
        <div id="dish-container" class="span6">
            <dl id="dish-list">
                {% for dish in dishes_with_no_category %}
                    <dd class="tag dish" dish-id="{{ dish.id }}"><span class="dish-name">{{ dish.name }}</span>
                        <a href="#" class="close">&times;</a>

                                <span class="dish-info"> <span class="price">{{ dish.price }} 元</span><span
                                        class="unit"> /{{ dish.unit }} &times; </span><a
                                        class="num">1</a>&nbsp;&nbsp; </span></dd>
                {% endfor %}
                {% for category in categories %}
                    <dt class="category tag" category-id="{{ category.id }}">{{ category.name }} <a
                            href="#" class="close cb">&times;</a></dt>
                    {% for dish in category.my_dishes %}
                        <dd class="tag dish" dish-id="{{ dish.id }}"><span class="dish-name">{{ dish.name }}</span>
                            <a href="#" class="close">&times;</a>
                                <span class="dish-info"> <span class="price">{{ dish.price }} 元</span><span
                                        class="unit"> /{{ dish.unit }} &times; </span><a
                                        class="num">1</a>&nbsp;&nbsp; </span></dd>
                    {% endfor %}
                {% endfor %}
                {% for category in categories_with_no_dish %}
                    <dt class="category tag" category-id="{{ category.id }}">{{ category.name }} <a
                            href="#" class="close cb">&times;</a></dt>
                {% endfor %}
            </dl>
        </div>
        <form class="form-horizontal span4" action="{% url add_menu %}" id="save-menu-form">


            <div class="control-group">
                <label class="control-label" for="id_num_persons">就餐人数</label>

                <div class="controls">
                    <input type="text" name="num_persons" class="input-small" id="id_num_persons"
                           value="{{ menu.num_persons }}">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" for="id_average_price">均价 (元/人)</label>

                <div class="controls">
                    {{ menu_form.average_price }}
                </div>
            </div>

            <button class="btn btn-primary " id="save-menu-btn">保存套餐</button>
        </form>
        <div id="menu-container" class="span4">

            <dl class="menu-items" id="menu-items">
                {% for item in menu.items %}
                    {% if item.num %}
                        <dd class="tag dish" dish-id="{{ item.dish.id }}"><span
                                class="dish-name">{{ item.dish.name }}</span>
                            <a href="#" class="close">&times;</a>

                                <span class="dish-info"> <span class="price">{{ item.dish.price }} 元</span><span
                                        class="unit"> /{{ item.dish.unit }} &times; </span><span
                                        class="num">{{ item.num }}</span>&nbsp;&nbsp; </span>
                        </dd>
                    {% else %}
                        <dt class="category tag" category-id="{{ item.category.id }}">{{ item.category.name }}
                            <a href="#" class="close cb">&times;</a>
                        </dt>
                    {% endif %}
                {% endfor %}
            </dl>
        </div>
    </div>
    <div class="hide" id="add-category-dialog" title="添加分类">
        <form id="add-dish-category" class="form" action="{% url add_dish_category %}" method="post">
            <input type="text" id="category-name" name="category-name" class="input" placeholder="请输入分类名称">
        </form>
    </div>
    <div id="nav-active-id" style="display: none">nav-menu</div>
{% endblock %}