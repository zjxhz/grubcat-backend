{% extends "base.html" %}
{% load static_asset %}
{% load static from staticfiles %}{% load assets %}
{% block title %}{{ group.name }}{% endblock %}
{% block active-nav-id %}nav-group{% endblock %}


{% block page_css %}
    {{ block.super }}
    {% assets "bootstrap_css" %}
        <link href="{% static_asset ASSET_URL %}" media="screen" rel="stylesheet" type="text/css">
    {% endassets %}
    <link rel="stylesheet" href="{% static 'css/ui/jquery-ui-bootstrap/jquery-ui-1.8.16.bootstrap.css' %}">
    <style type="text/css">
        .error {
            margin: auto auto;
            width: auto;
            padding: 0px;
        }

        #div_id_logo .controls label {
            margin-left: 15px;;
            margin-top: 5px;;
        }

        #logo-clear_id {
            display: block;
            float: left;
            margin-top: 8px;;
        }

        #id_logo {
            -webkit-box-shadow: none;
            -moz-box-shadow: none;
            box-shadow: none;
        }

        .form-horizontal .control-label {
            width: 60px;
        }

        .form-horizontal .controls {
            margin-left: 80px;
        }

        #div_id_logo {
            margin-top: 10px;;
        }
    </style>

{% endblock %}
{% block content %}
    圈子详情<br/>
    名称:{{ group.name }}<br/>
    描述{{ group.desc }}<br/>
    分类：{{ group.category.name }}<br/>
    公开：{{ group.privacy }}<br/>
    创建者：{{ group.owner }}

    {% ifequal request.user group.owner %}
        <a href="{% url edit_group group.id %}">修改圈子信息</a>
        <a href="{% url edit_group_logo group.id %}" id="id_edit_logo_link">修改Logo</a>
    {% endifequal %}
    <div id="id_edit_logo_dialog" class="hide">

    </div>

{% endblock %}
{% block base_js %}
    {{ block.super }}
    {% assets "jquery_ui_js" %}
        <script type="text/javascript" src="{% static_asset ASSET_URL %}"></script>
    {% endassets %}
    {% assets "jquery_form_js" %}
        <script type="text/javascript" src="{% static_asset ASSET_URL %}"></script>
    {% endassets %}
{% endblock %}
{% block page_js %}
    <script type="text/javascript">
        function loadEditLogoPage() {
            $("#id_create_group_form").ajaxForm({
                success:function (html) {
                    var $html = $(html);
                    if ($html.is("a.auto-close") && $html.attr('href')) {
                        window.location.href = $html.attr('href');
                    } else {
                        $("#id_edit_logo_dialog").html($html.find(".content"));
                        loadEditLogoPage();
                    }
                }
            })
            $("#id_edit_logo_dialog").dialog({
                autoOpen:true,
                title:"修改Logo",
                modal:true,
                width:440,
                position:['center', 100],
                resizable:false
            });
            $("<br/>").insertBefore($("#logo-clear_id"));
            $("input[type=submit]").focus()
        }
        $(document).ready(function () {
            $("#id_edit_logo_link").click(function () {
                $("#id_edit_logo_dialog").load($("#id_edit_logo_link").attr('href') + " .content", loadEditLogoPage);
                return false;
            })
        })
    </script>
{% endblock %}